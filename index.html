<!DOCTYPE html>
    <html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Kafe Menüsü - QR Kod Tarayın</title>
    <link rel="stylesheet" href="styles.css?v=30">
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&family=Open+Sans:wght@300;400;600&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <!-- Header with Cafe Image -->
        <header class="header">
            <div class="cafe-image">
                <img src="https://images.unsplash.com/photo-1554118811-1e0d58224f24?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80" alt="Cafe Interior" />
                <div class="cafe-overlay">
                    <h1 class="cafe-name">THEE BBUBB CAFE</h1>
                    <p class="cafe-description">Lezzetli kahve ve taze yemekler için bizi tercih edin</p>
                </div>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="main-nav">
            <h2>Menümüz</h2>
            <div class="category-grid">
                <div class="category-card" data-category="hot-drinks">
                    <div class="category-icon">
                        <img src="hotdrinks_icon.png" alt="Sıcak İçecekler" style="width: 40px; height: 40px;">
                    </div>
                    <h3>Sıcak İçecekler</h3>
                </div>
                <div class="category-card" data-category="cold-drinks">
                    <div class="category-icon">
                        <img src="colddrinks_icon.png" alt="Soğuk İçecekler" style="width: 40px; height: 40px;">
                    </div>
                    <h3>Soğuk İçecekler</h3>
                </div>
                <div class="category-card" data-category="meals">
                    <div class="category-icon">
                        <img src="foods_icon.png" alt="Yemekler" style="width: 40px; height: 40px;">
                    </div>
                    <h3>Yemekler</h3>
                </div>
                <div class="category-card" data-category="desserts">
                    <div class="category-icon">
                        <img src="desserts_icon.png" alt="Tatlılar" style="width: 40px; height: 40px;">
                    </div>
                    <h3>Tatlılar</h3>
                </div>
                <div class="category-card wide" data-category="nargile">
                    <div class="category-icon">
                        <img src="hookah-icon.png" alt="Nargile" style="width: 40px; height: 40px;">
                    </div>
                    <h3>Nargile</h3>
                </div>
            </div>
        </nav>
        
        <!-- Instagram Button -->
        <div class="instagram-section">
            <a href="https://www.instagram.com/theebbubb/" id="instagram-link" class="instagram-btn">
                <img src="instagram_icon.png" alt="Instagram" class="instagram-logo">
            </a>
        </div>

        <!-- Category Content -->
        <main class="category-content" id="category-content">
            <!-- Content will be dynamically loaded here -->
        </main>

        <!-- Back Button -->
        <button class="back-btn" id="back-btn" style="display: none;">
            ← Menüye Dön
        </button>
        
        <!-- Secure Admin Access - Hidden and protected -->
    </div>

    <script src="script.js"></script>
    <script>
        // Instagram button handler - try app first, then website in new tab
        document.addEventListener('DOMContentLoaded', function() {
            const instagramLink = document.getElementById('instagram-link');
            if (instagramLink) {
                instagramLink.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // Try to open Instagram app first
                    const appUrl = 'instagram://user?username=theebbubb';
                    const webUrl = 'https://www.instagram.com/theebbubb/';
                    
                    // Create a hidden iframe to test if the app opens
                    const iframe = document.createElement('iframe');
                    iframe.style.display = 'none';
                    iframe.src = appUrl;
                    document.body.appendChild(iframe);
                    
                    // Set a timeout to check if the app opened
                    setTimeout(() => {
                        document.body.removeChild(iframe);
                        // If we're still here, the app didn't open, so open the website in new tab
                        window.open(webUrl, '_blank');
                    }, 1000);
                });
            }
        });

        // Back gesture system with confirmation popup - only on main page
        let isBackConfirmationShown = false;
        let isNavigating = false;
        
        // Check if we're on main page (no category content visible)
        function isOnMainPage() {
            const categoryContent = document.getElementById('category-content');
            const backBtn = document.getElementById('back-btn');
            return categoryContent && categoryContent.style.display !== 'block' && 
                   backBtn && backBtn.style.display === 'none';
        }
        
        // Navigate back to main page
        function goToMainPage() {
            if (isNavigating) return;
            isNavigating = true;
            
            const categoryContent = document.getElementById('category-content');
            const backBtn = document.getElementById('back-btn');
            const mainNav = document.querySelector('.main-nav');
            const instagramSection = document.querySelector('.instagram-section');
            
            if (categoryContent) categoryContent.style.display = 'none';
            if (backBtn) backBtn.style.display = 'none';
            if (mainNav) mainNav.style.display = 'block';
            if (instagramSection) instagramSection.style.display = 'flex';
            
            // Push new state to prevent back button issues
            history.pushState(null, null, location.href);
            
            // Reset back confirmation flag to prevent popup
            isBackConfirmationShown = false;
            
            setTimeout(() => {
                isNavigating = false;
            }, 200);
        }
        
        // Handle browser back button
        window.addEventListener('popstate', function(event) {
            if (isNavigating) return;
            
            // Small delay to ensure navigation is complete
            setTimeout(() => {
                if (!isBackConfirmationShown && !isNavigating) {
                    event.preventDefault();
                    if (isOnMainPage()) {
                        showBackConfirmation();
                    } else {
                        goToMainPage();
                    }
                }
            }, 50);
        });

        // Handle Android back button
        document.addEventListener('backbutton', function(event) {
            if (isNavigating) return;
            
            // Small delay to ensure navigation is complete
            setTimeout(() => {
                if (!isBackConfirmationShown && !isNavigating) {
                    event.preventDefault();
                    if (isOnMainPage()) {
                        showBackConfirmation();
                    } else {
                        goToMainPage();
                    }
                }
            }, 50);
        }, false);

        function showBackConfirmation() {
            if (isBackConfirmationShown) return;
            isBackConfirmationShown = true;

            // Create overlay
            const overlay = document.createElement('div');
            overlay.id = 'back-confirmation-overlay';
            overlay.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.7);
                z-index: 10000;
                display: flex;
                justify-content: center;
                align-items: center;
                font-family: 'Nunito', sans-serif;
            `;

            // Create popup
            const popup = document.createElement('div');
            popup.style.cssText = `
                background: white;
                padding: 2rem;
                border-radius: 15px;
                text-align: center;
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
                max-width: 300px;
                width: 90%;
            `;

            popup.innerHTML = `
                <h3 style="margin: 0 0 1rem 0; color: #333; font-size: 1.2rem;">Çıkmak İstiyor Musunuz?</h3>
                <div style="display: flex; gap: 1rem; justify-content: center;">
                    <button id="confirm-exit" style="
                        background: #e74c3c;
                        color: white;
                        border: none;
                        padding: 0.8rem 1.5rem;
                        border-radius: 8px;
                        font-size: 1rem;
                        cursor: pointer;
                        font-family: 'Nunito', sans-serif;
                    ">Çık</button>
                    <button id="stay-here" style="
                        background: #27ae60;
                        color: white;
                        border: none;
                        padding: 0.8rem 1.5rem;
                        border-radius: 8px;
                        font-size: 1rem;
                        cursor: pointer;
                        font-family: 'Nunito', sans-serif;
                    ">Kal</button>
                </div>
            `;

            overlay.appendChild(popup);
            document.body.appendChild(overlay);

            // Handle button clicks
            document.getElementById('confirm-exit').addEventListener('click', function() {
                document.body.removeChild(overlay);
                isBackConfirmationShown = false;
                
                // Try to close the tab/window
                try {
                    // For mobile browsers, try to close the tab
                    if (window.close) {
                        window.close();
                    }
                    // For some browsers, try to navigate back in history
                    if (window.history.length > 1) {
                        window.history.go(-window.history.length);
                    }
                    // Last resort: try to close the window
                    window.close();
                } catch (e) {
                    // If all else fails, show a message
                    alert('Lütfen tarayıcıyı manuel olarak kapatın.');
                }
            });

            document.getElementById('stay-here').addEventListener('click', function() {
                document.body.removeChild(overlay);
                isBackConfirmationShown = false;
                // Push a new state to prevent immediate back
                history.pushState(null, null, location.href);
            });
        }

        // Push initial state to handle back button
        history.pushState(null, null, location.href);
        
        // Mobile-friendly admin access - 5 clicks on cafe name OR long press
        let clickCount = 0;
        let clickTimeout;
        let longPressTimer;
        let isLongPress = false;
        
        // 5-click method
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('cafe-name')) {
                clickCount++;
                
                if (clickCount === 5) {
                    // Show admin login
                    showAdminLogin();
                    clickCount = 0;
                } else {
                    clearTimeout(clickTimeout);
                    clickTimeout = setTimeout(() => {
                        clickCount = 0;
                    }, 2000); // Reset after 2 seconds
                }
            } else {
                clickCount = 0;
            }
        });
        
        // Long press method for mobile
        document.addEventListener('touchstart', function(e) {
            if (e.target.classList.contains('cafe-name')) {
                isLongPress = false;
                longPressTimer = setTimeout(() => {
                    isLongPress = true;
                    showAdminLogin();
                }, 2000); // 2 second long press
            }
        });
        
        document.addEventListener('touchend', function(e) {
            if (e.target.classList.contains('cafe-name')) {
                clearTimeout(longPressTimer);
            }
        });
        
        // Also add long press for mouse (desktop)
        document.addEventListener('mousedown', function(e) {
            if (e.target.classList.contains('cafe-name')) {
                isLongPress = false;
                longPressTimer = setTimeout(() => {
                    isLongPress = true;
                    showAdminLogin();
                }, 2000); // 2 second long press
            }
        });
        
        document.addEventListener('mouseup', function(e) {
            if (e.target.classList.contains('cafe-name')) {
                clearTimeout(longPressTimer);
            }
        });
        
        function showAdminLogin() {
            // Create login overlay
            const overlay = document.createElement('div');
            overlay.id = 'admin-overlay';
            overlay.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.9);
                z-index: 999999;
                display: flex;
                justify-content: center;
                align-items: center;
                font-family: 'Nunito', sans-serif;
            `;
            
            overlay.innerHTML = `
                <div style="
                    background: white;
                    padding: 2rem;
                    border-radius: 15px;
                    box-shadow: 0 10px 30px rgba(0,0,0,0.3);
                    max-width: 400px;
                    width: 90%;
                    text-align: center;
                ">
                    <h2 style="color: #e67e22; margin-bottom: 1rem;">🔐 Admin Access</h2>
                    <p style="color: #666; margin-bottom: 1.5rem;">Enter your password</p>
                    <input type="password" id="admin-password" placeholder="Enter password" 
                           style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; margin-bottom: 1rem; font-size: 1rem;">
                    <div style="display: flex; gap: 10px;">
                        <button id="admin-login-btn" style="
                            background: #e67e22; color: white; border: none; padding: 12px 24px; 
                            border-radius: 8px; cursor: pointer; flex: 1; font-weight: 600;
                        ">Login</button>
                        <button id="admin-cancel-btn" style="
                            background: #7f8c8d; color: white; border: none; padding: 12px 24px; 
                            border-radius: 8px; cursor: pointer; flex: 1; font-weight: 600;
                        ">Cancel</button>
                    </div>
                    <div id="admin-error" style="color: #e74c3c; margin-top: 1rem; display: none;"></div>
                </div>
            `;
            
            document.body.appendChild(overlay);
            
            // Focus on password input
            document.getElementById('admin-password').focus();
            
            // Setup event listeners
            document.getElementById('admin-login-btn').addEventListener('click', handleAdminLogin);
            document.getElementById('admin-cancel-btn').addEventListener('click', hideAdminLogin);
            
            // Enter key to login
            document.getElementById('admin-password').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    handleAdminLogin();
                }
            });
        }
        
        function handleAdminLogin() {
            const password = document.getElementById('admin-password').value;
            const errorDiv = document.getElementById('admin-error');
            
            if (password === 'SecureAdmin2024!') {
                // Successful login
                hideAdminLogin();
                window.location.href = 'admin.html';
            } else {
                errorDiv.textContent = 'Invalid password!';
                errorDiv.style.display = 'block';
            }
        }
        
        function hideAdminLogin() {
            const overlay = document.getElementById('admin-overlay');
            if (overlay) {
                overlay.remove();
            }
        }
        
        // Emergency escape - press Escape key to close any popups
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                const overlay = document.getElementById('admin-overlay');
                if (overlay) {
                    overlay.remove();
                }
            }
        });
    </script>
</body>
</html>
